<!-- BEGIN: contenido_principal -->
<script type="text/javascript">
	
	//If user hits Enter with focus in email field…
	function iniciarProcesoPassword(evento){
		if(evento.keyCode===13){ // keycode 13 is Enter key
			recordarPassword();
		}
	}

	//If user clicks Send button…
	function recordarPassword(){
		let email=document.frmRememberPassword.txtEmail;
		//trim strips whitespace from input string, so if no other characters…
		if(trim(email.value)===""){
			loadEasyNotify("{STATIC_REMEMBER_PASSWORD_MAIL_EMPTY}",1);
			email.value="";
		}else if(!validarEmail(email.value)){
			loadEasyNotify("{STATIC_REMEMBER_PASSWORD_MAIL_INVALID_FORMAT}",1);
		}else{
			let botonEnviar=document.getElementById("btnEnviar");
			
			//Disable Send button until Ajax call is completed
			botonEnviar.disabled="disabled";
			
			let ajax=nuevoAjax();
			let respuesta;
			let mensaje;
			ajax.open("GET","ajax/send_remember_password.php?txtEmail="+email.value+"&txtCode="+document.frmRememberPassword.txtCode.value);
			ajax.onreadystatechange=function(){
				if(ajax.readyState===4){
					respuesta=parseInt(ajax.responseText);
					/*
					 * Based on Ajax result (1, 2 ,3 or 4)
					 * 1 = Email sent OK
					 * 2 = Email not sent
					 * 3 = No user with that email address
					 * 4 = Captcha is invalid
					 */
					switch(respuesta){
						case 1:
							mensaje="{STATIC_REMEMBER_PASSWORD_MAIL_OK}";
							tipoNotifacion=2;
							//Refresh captcha image and empty captcha variable
							refrescarCaptcha();
							document.frmRememberPassword.txtCode.value="";
							break;
						case 2:
							mensaje="{STATIC_REMEMBER_PASSWORD_MAIL_ERROR}";
							tipoNotifacion=1;
							break;
						case 3:
							mensaje="{STATIC_REMEMBER_PASSWORD_MAIL_NOT_FOUND}";
							tipoNotifacion=1;
							break;
						case 4:
							mensaje="{STATIC_REMEMBER_PASSWORD_INVALID_CAPTCHA}";
							tipoNotifacion=1;
							break;
					}
					loadEasyNotify(mensaje,tipoNotifacion);
					
					//Enable Send button
					botonEnviar.disabled="";
				}
			};
			ajax.send(null);
		}
	}
</script>
<form name="frmRememberPassword" id="frmRememberPassword" method="post" onsubmit="return false" autocomplete="off">
	<div id="boxRememberPasswordNotify"><div id="containerEasyNotify" class="layoutRememberPasswordNotify"></div></div>
	<table border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td colspan="2" id="inputEmail"><input type="text" name="txtEmail" id="txtEmail" value="{STATIC_REMEMBER_PASSWORD_MAIL}" onfocus="limpiarInputValue(this,'{STATIC_REMEMBER_PASSWORD_MAIL}');" onblur="restaurarInputValue(this,'{STATIC_REMEMBER_PASSWORD_MAIL}');" onkeypress="iniciarProcesoPassword(event)"><br></td>
		</tr>
		<tr id="containerCaptcha">
			<td colspan="2">
				<table border="0" cellpadding="0" cellspacing="0">
					<tr>
						<td><img id="image" src="../classes/securimage/securimage_show.php?sid={SESSION_ID}"></td>
						<td id="containerInputCaptcha"><input type="text" name="txtCode" id="txtCode" maxlength="6"></td>
						<td id="containerReloadCaptcha"><img id="reload" src="images/securimage/refresh.png" title="Reload" onclick="refrescarCaptcha();"></td>
					</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td class="inputButton" style="padding:0px;">
				<input type="button" name="btnEnviar" id="btnEnviar" onclick="recordarPassword();" value="{STATIC_REMEMBER_PASSWORD_SEND_BUTTON}">
			</td>
			<td class="inputButton">
				<input type="button" name="btnVolver" id="btnVolver" onclick="window.location='index.php'" value="{STATIC_REMEMBER_PASSWORD_RETURN_BUTTON}">
			</td>
		</tr>
	</table>
</form>
<!-- END: contenido_principal -->