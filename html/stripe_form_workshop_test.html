<!-- BEGIN: contenido_principal -->
<h2 class="titleSection">{STATIC_STRIPE_TITLE}</h2>

<p>{STATIC_STRIPE_INTRO}</p>

<div class="container">
    <div class="row stripeLogo">
        <img src="images/pictures/logos/powered_by_stripe@2x.png">
    </div>

    <div class="row stripe-form-amount text-info font-weight-bold">
        <p>{STATIC_STRIPE_PAY1}{PRICE} {STATIC_STRIPE_PAY2} {PRODUCT}</p>
    </div>

    <div class="row stripe-form-name">
        <div class="col-12">
            <label for="cardholder-name">{STATIC_STRIPE_NAME}</label>
            <input id="cardholder-name" class="form-control" type="text" autocomplete="off" required>
        </div>
    </div>

    <!-- placeholder for Elements -->
    <div class="row stripe-form-card">
        <div class="col-12">
            <label for="card-element">{STATIC_STRIPE_DETAILS}</label>
            <div id="card-element" class="form-control">
                <!-- Stripe Card Element -->
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div id="card-errors">
                <!-- Stripe Error Message -->
            </div>
        </div>
    </div>

    <button id="card-button" class="btn btn-primary" type="submit" data-secret="{CLIENT_SECRET}">
        {STATIC_STRIPE_SUBMIT}
    </button>
</div>


<script>
    let stripe = Stripe('{STRIPE_PK}', {
        betas: ['payment_intent_beta_3']
    });

    let elements = stripe.elements({
        fonts: [
            {
                cssSrc: 'https://fonts.googleapis.com/css?family=Quicksand',
            },
        ],
    });

    let elementStyles = {
        base: {
            color: '#1A1E21',
            fontWeight: 500,
            fontFamily: 'Quicksand, Open Sans, Segoe UI, sans-serif',
            fontSize: '16px',
            fontSmoothing: 'antialiased',

            ':focus': {
                color: '#3A4160',
            },

            '::placeholder': {
                color: '#7F91B2',
            },

            ':focus::placeholder': {
                color: '#A9B6C6',
            },
        },
        invalid: {
            color: '#fff',
            ':focus': {
                color: '#FA755A',
            },
            '::placeholder': {
                color: '#FFCCA5',
            },
        },
    };

    let elementClasses = {
        focus: 'focus',
        empty: 'empty',
        invalid: 'invalid',
    };

    let cardElement = elements.create('card', {
        style: elementStyles,
        classes: elementClasses,
    });
    cardElement.mount('#card-element');

    let cardholderName = document.getElementById('cardholder-name');
    let cardButton = document.getElementById('card-button');
    let clientSecret = cardButton.dataset.secret;
    let errorPanel = document.getElementById('card-errors');

    cardButton.addEventListener('click', function (ev) {
        if (cardholderName.value === '') {
            errorPanel.textContent = 'Please enter the cardholderâ€™s name';
            errorPanel.style.display = "block";
            return;
        }
        mensajeCargando("{STATIC_GLOBAL_SENDING}...");
        stripe.handleCardPayment(
            clientSecret, cardElement, {
                source_data: {
                    owner: {name: cardholderName.value}
                }
            }
        ).then(function (result) {
                if (result.error) {
                    errorPanel.textContent = result.error.message;
                    errorPanel.style.display = 'block';
                    $.unblockUI();
                } else {
                    errorPanel.textContent = '';
                    errorPanel.style.display = 'none';
                    window.location = 'stripe_result_workshop_test.php';
                }
            }
        )
    })

</script>

<!-- END: contenido_principal -->

